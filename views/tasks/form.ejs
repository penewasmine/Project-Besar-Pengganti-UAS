<%
  const isEdit = !!task;
  const action = isEdit ? `/tasks/${task.id}?_method=PUT` : "/tasks";

  const body = `
  <div class="mb-3">
    <h2 class="mb-0">${isEdit ? "Edit" : "Tambah"} Tugas</h2>
    <div class="text-muted">Input data untuk perhitungan prioritas</div>
  </div>

  <div class="card shadow-sm rounded-4">
    <div class="card-body p-4">
      <form method="post" action="${action}" class="row g-3">
        <div class="col-md-6">
          <label class="form-label">Judul Tugas</label>
          <input class="form-control" name="title" required value="${isEdit ? task.title : ""}">
        </div>
        <div class="col-md-6">
          <label class="form-label">Mata Kuliah</label>
          <input class="form-control" name="course" required value="${isEdit ? task.course : ""}">
        </div>

        <div class="col-md-4">
          <label class="form-label">Deadline</label>
          <input class="form-control" type="date" name="dueDate" required value="${isEdit ? task.dueDate : ""}">
        </div>

        <div class="col-md-4">
          <label class="form-label">Estimasi (jam)</label>
          <input class="form-control" type="number" min="0.25" step="0.25" name="estimatedHours" required value="${isEdit ? task.estimatedHours : ""}">
        </div>

        <div class="col-md-4">
          <label class="form-label">Kesulitan (1-5)</label>
          <select class="form-select" name="difficulty" required>
            ${[1,2,3,4,5].map(v => `<option value="${v}" ${(isEdit && task.difficulty===v) ? "selected" : ""}>${v}</option>`).join("")}
          </select>
        </div>

        <div class="col-12 d-flex gap-2">
          <button class="btn btn-primary">${isEdit ? "Simpan" : "Tambah"}</button>
          <a class="btn btn-outline-secondary" href="/tasks">Kembali</a>
        </div>
      </form>
    </div>
  </div>
  `;
%>
<%- include("../layout", { title, body }) %>
