<%
  const rows = tasks.map(t => `
    <tr>
      <td class="fw-semibold">${t.title}</td>
      <td><span class="badge text-bg-secondary">${t.course}</span></td>
      <td>${new Date(t.dueDate + "T00:00:00").toLocaleDateString("id-ID")}</td>
      <td>${Number(t.estimatedHours).toFixed(2)} jam</td>
      <td><span class="badge text-bg-info">${t.difficulty}</span></td>
      <td class="text-end">
        <a class="btn btn-sm btn-outline-primary" href="/sessions/${t.id}">Sesi</a>
        <a class="btn btn-sm btn-outline-warning" href="/tasks/${t.id}/edit">Edit</a>
        <form class="d-inline" method="post" action="/tasks/${t.id}?_method=DELETE">
          <button class="btn btn-sm btn-outline-danger" onclick="return confirm('Hapus tugas?')">Hapus</button>
        </form>
      </td>
    </tr>
  `).join("");

  const body = `
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h2 class="mb-0">Daftar Tugas</h2>
      <div class="text-start pb-4 small" style="color: #aeaeae;">Ayo kerjakan tugasmu!</div>
    </div>
    <a class="btn btn-primary" href="/tasks/new">+ Tambah</a>
  </div>

  <div class="card shadow-sm rounded-4">
    <div class="table-responsive">
      <table class="table table-hover mb-0 align-middle">
        <thead class="table-dark">
          <tr>
            <th>Judul</th><th>Mata Kuliah</th><th>Deadline</th><th>Estimasi</th><th>Kesulitan</th><th class="text-end">Aksi</th>
          </tr>
        </thead>
        <tbody>
          ${rows || `<tr><td colspan="6" class="text-center text-muted p-4">Belum ada tugas. Klik <b>Tambah</b>.</td></tr>`}
        </tbody>
      </table>
    </div>
  </div>
  `;
%>
<%- include("../layout", { title, body }) %>
